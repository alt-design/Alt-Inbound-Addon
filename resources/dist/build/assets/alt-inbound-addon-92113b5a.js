function f(a,t,e,s,r,l,c,d){var i=typeof a=="function"?a.options:a;t&&(i.render=t,i.staticRenderFns=e,i._compiled=!0),s&&(i.functional=!0),l&&(i._scopeId="data-v-"+l);var o;if(c?(o=function(n){n=n||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!n&&typeof __VUE_SSR_CONTEXT__<"u"&&(n=__VUE_SSR_CONTEXT__),r&&r.call(this,n),n&&n._registeredComponents&&n._registeredComponents.add(c)},i._ssrRegister=o):r&&(o=d?function(){r.call(this,(i.functional?this.parent:this).$root.$options.shadowRoot)}:r),o)if(i.functional){i._injectStyles=o;var m=i.render;i.render=function(h,u){return o.call(u),m(h,u)}}else{var p=i.beforeCreate;i.beforeCreate=p?[].concat(p,o):[o]}return{exports:a,options:i}}const v={props:{title:String,action:String,blueprint:Array,meta:Array,redirectTo:String,values:Array,data:Array,items:Array,blacklistset:Number},computed:{lastPage(){return Math.ceil(this.totalItems/this.perPage)}},data(){return{itemsReady:[],itemsSliced:[],perPage:10,currentPage:1,totalItems:0,selectedFile:null,search:"",fileName:"Choose a file...",selectedPage:"",blacklist:1,customView:""}},watch:{search:{immediate:!0,handler(){this.sliceItems()}}},mounted(){this.blacklist=this.blacklistset,this.itemsReady=this.items,this.totalItems=this.items.length,this.sliceItems()},methods:{updateItems(a){this.itemsReady=a.data.data,this.totalItems=a.data.data.length,this.sliceItems(),this.$forceUpdate()},setPage(a){this.currentPage=a,this.sliceItems()},sliceItems(){let a=this.itemsReady;this.search&&(a=a.filter(s=>Object.values(s).map(l=>l.toString().toLowerCase()).some(l=>l.includes(this.search.toLowerCase()))));const t=(this.currentPage-1)*this.perPage,e=t+this.perPage;this.totalItems=a.length,this.itemsSliced=a.slice(t,e)},deleteRedirect(a,t){confirm("Are you sure you want to delete this block?")&&Statamic.$axios.post(cp_url("alt-design/alt-inbound/delete"),{ip:a,id:t}).then(e=>{this.updateItems(e)}).catch(e=>{console.log(e)})},importFromCSV(){if(!this.selectedFile){alert("You haven't attached a CSV file!");return}var a=new FormData;a.append("file",this.selectedFile),a.append("data",JSON.stringify(this.itemsReady)),Statamic.$axios.post(cp_url("alt-design/alt-inbound/import"),a,{headers:{"Content-Type":"multipart/form-data"}}).then(t=>{location.reload()}).catch(t=>{console.log(t)})},handleFileUpload(a){this.selectedFile=a.target.files[0],this.fileName=this.selectedFile?this.selectedFile.name:"Choose a file..."},dropdownPageChange(){this.setPage(this.selectedPage)},blacklistChange(){this.blacklist=Math.abs(this.blacklist-1);var a=new FormData;a.append("blacklist",this.blacklist),Statamic.$axios.post(cp_url("alt-design/alt-inbound/blacklist"),a,{headers:{"Content-Type":"multipart/form-data"}}).then(t=>{console.log("Blacklist state "+this.blacklist)}).catch(t=>{console.log(t)})},viewChanged(){console.log("View name changed");var a=new FormData;a.append("custom-view",this.customView),Statamic.$axios.post(cp_url("alt-design/alt-inbound/custom-view"),a,{headers:{"Content-Type":"multipart/form-data"}}).then(t=>{console.log("custom view "+this.customView)}).catch(t=>{console.log(t)})}}};var g=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"alt-redirect"}},[e("publish-form",{attrs:{title:t.title,action:t.action,blueprint:t.blueprint,meta:t.meta,values:t.values},on:{saved:function(s){return t.updateItems(s)}}}),e("div",{staticClass:"card overflow-hidden p-0"},[e("div",{staticClass:"mt-4 pb-2 px-4 flex items-center"},[e("div",{staticClass:"w-1/3 flex items-center"},[e("label",{staticClass:"switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.blacklist,expression:"blacklist"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.blacklist)?t._i(t.blacklist,null)>-1:t.blacklist},on:{click:function(s){return t.blacklistChange()},change:function(s){var r=t.blacklist,l=s.target,c=!!l.checked;if(Array.isArray(r)){var d=null,i=t._i(r,d);l.checked?i<0&&(t.blacklist=r.concat([d])):i>-1&&(t.blacklist=r.slice(0,i).concat(r.slice(i+1)))}else t.blacklist=c}}}),e("span",{staticClass:"slider round"})]),e("div",{staticClass:"ml-4 text-sm"},[t._v("Whitelist / Blacklist")])]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],staticClass:"input-text w-1/3",attrs:{type:"text",placeholder:"Search"},domProps:{value:t.search},on:{input:function(s){s.target.composing||(t.search=s.target.value)}}})]),e("div",{staticClass:"px-2"},[e("table",{staticClass:"data-table",staticStyle:{"table-layout":"fixed"},attrs:{"data-size":"sm",tabindex:"0"}},[t._m(0),e("tbody",t._l(t.itemsSliced,function(s){return e("tr",{key:s.id,staticStyle:{width:"100%",overflow:"clip"}},[e("td",[t._v(" "+t._s(s.ip)+" ")]),e("td",[e("button",{staticClass:"btn",staticStyle:{color:"#bc2626"},on:{click:function(r){return t.deleteRedirect(s.ip,s.id)}}},[t._v("Remove ")])])])}),0)])]),e("div",{staticClass:"pagination text-sm py-4 px-4 flex items-center justify-between"},[e("div",{staticClass:"w-1/3 flex items-center"},[t._v(" Page "),e("span",{staticClass:"font-semibold mx-1",domProps:{innerHTML:t._s(t.currentPage)}}),t._v(" of "),e("span",{staticClass:"mx-1",domProps:{innerHTML:t._s(t.lastPage)}})]),e("div",{staticClass:"w-1/3 flex items-center justify-center"},[e("span",{staticClass:"cursor-pointer",staticStyle:{height:"15px",margin:"0 15px",width:"12px"},on:{click:function(s){return t.setPage(t.currentPage-1>0?t.currentPage-1:1)}}},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"205",height:"205",viewBox:"0 0 205 205"}},[e("defs",[e("clipPath",{attrs:{id:"clip-LEFT"}},[e("rect",{attrs:{width:"205",height:"205"}})])]),e("g",{attrs:{id:"LEFT","clip-path":"url(#clip-LEFT)"}},[e("rect",{attrs:{width:"205",height:"205",fill:"#fff"}}),e("path",{attrs:{stroke:"#2e9fff",fill:"#2e9fff",id:"Icon_awesome-arrow-left","data-name":"Icon awesome-arrow-left",d:"M114.961,184.524l-9.91,9.91a10.669,10.669,0,0,1-15.132,0L3.143,107.7a10.669,10.669,0,0,1,0-15.132L89.919,5.794a10.669,10.669,0,0,1,15.132,0l9.91,9.91a10.725,10.725,0,0,1-.179,15.311L60.994,82.259H189.283A10.687,10.687,0,0,1,200,92.972v14.284a10.687,10.687,0,0,1-10.713,10.713H60.994l53.789,51.244A10.648,10.648,0,0,1,114.961,184.524Z",transform:"translate(2.004 2.353)"}})])])]),t.currentPage>1?e("span",{staticClass:"cursor-pointer py-1 mx-1",on:{click:function(s){return t.setPage(1)}}},[t._v("1")]):t._e(),t.currentPage==1?e("span",{staticClass:"cursor-pointer py-1 mx-1 font-semibold",on:{click:function(s){return t.setPage(1)}}},[t._v("1")]):t._e(),t.currentPage>3?e("span",[t._v("...")]):t._e(),t.currentPage>2?e("span",{staticClass:"cursor-pointer py-1 mx-1",on:{click:function(s){return t.setPage(t.currentPage-1)}}},[t._v(t._s(t.currentPage-1))]):t._e(),t.currentPage!==1&&t.currentPage!==t.lastPage?e("span",{staticClass:"cursor-pointer py-1 mx-1 font-semibold"},[t._v(t._s(t.currentPage))]):t._e(),t.currentPage<t.lastPage-1?e("span",{staticClass:"cursor-pointer py-1 mx-1",on:{click:function(s){return t.setPage(t.currentPage+1)}}},[t._v(t._s(t.currentPage+1))]):t._e(),t.currentPage<t.lastPage-2?e("span",[t._v("...")]):t._e(),t.currentPage<t.lastPage?e("span",{staticClass:"cursor-pointer py-1 mx-1",on:{click:function(s){return t.setPage(t.lastPage)}}},[t._v(t._s(t.lastPage))]):t._e(),t.currentPage==t.lastPage&&t.lastPage!=1?e("span",{staticClass:"cursor-pointer py-1 mx-1 font-semibold",on:{click:function(s){return t.setPage(t.lastPage)}}},[t._v(t._s(t.lastPage))]):t._e(),e("span",{staticClass:"cursor-pointer",staticStyle:{height:"15px",margin:"0 15px",width:"12px"},on:{click:function(s){return t.setPage(t.currentPage+1<t.lastPage?t.currentPage+1:t.lastPage)}}},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"205",height:"205",viewBox:"0 0 205 205"}},[e("defs",[e("clipPath",{attrs:{id:"clip-RIGHT"}},[e("rect",{attrs:{width:"205",height:"205"}})])]),e("g",{attrs:{id:"RIGHT","clip-path":"url(#clip-RIGHT)"}},[e("rect",{attrs:{width:"205",height:"205",fill:"#fff"}}),e("path",{attrs:{stroke:"#2e9fff",fill:"#2e9fff",id:"Icon_awesome-arrow-left","data-name":"Icon awesome-arrow-left",d:"M85.032,184.524l9.91,9.91a10.669,10.669,0,0,0,15.132,0L196.85,107.7a10.669,10.669,0,0,0,0-15.132L110.073,5.794a10.669,10.669,0,0,0-15.132,0l-9.91,9.91a10.725,10.725,0,0,0,.179,15.311L139,82.259H10.71A10.687,10.687,0,0,0,0,92.972v14.284A10.687,10.687,0,0,0,10.71,117.969H139L85.21,169.214A10.648,10.648,0,0,0,85.032,184.524Z",transform:"translate(2.004 2.353)"}})])])])]),e("div",{staticClass:"w-1/3 flex justify-end"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedPage,expression:"selectedPage"}],staticClass:"w-1/2 text-sm",on:{change:[function(s){var r=Array.prototype.filter.call(s.target.options,function(l){return l.selected}).map(function(l){var c="_value"in l?l._value:l.value;return c});t.selectedPage=s.target.multiple?r:r[0]},t.dropdownPageChange]}},[e("option",{attrs:{value:"",disabled:""}},[t._v("Select Page")]),t._l(t.lastPage,function(s){return e("option",{key:s,domProps:{value:s}},[t._v(t._s(s))])})],2)])])]),e("div",{staticClass:"flex justify-between flex-wrap"},[e("div",{staticClass:"w-full card overflow-hidden p-0 mb-4 mt-4 px-4 py-4"},[e("span",{staticClass:"font-semibold mb-2"},[t._v("Custom Blocked View")]),e("br"),t._m(1),e("input",{directives:[{name:"model",rawName:"v-model",value:t.customView,expression:"customView"}],staticClass:"input-text w-1/3",attrs:{type:"text",placeholder:"Custom View Template"},domProps:{value:t.customView},on:{change:function(s){return t.viewChanged()},input:function(s){s.target.composing||(t.customView=s.target.value)}}})]),e("div",{staticClass:"w-full card overflow-hidden p-0 mb-4 mt-4 px-4 py-4"},[e("span",{staticClass:"font-semibold mb-2"},[t._v("CSV Export")]),e("br"),e("p",{staticClass:"text-sm mb-4"},[t._v("Exports CSV of all blocks, use this format on import.")]),e("a",{staticClass:"btn-primary",attrs:{href:t.cp_url("/alt-design/alt-inbound/export"),download:""}},[t._v("Export List")])]),e("div",{staticClass:"w-full card overflow-hidden p-0 mb-4 mt-4 px-4 py-4"},[e("span",{staticClass:"font-semibold mb-2"},[t._v("CSV Import")]),e("br"),e("p",{staticClass:"text-sm mb-4"},[t._v("Import CSV for Blocks, use the export format on import.")]),e("div",{staticClass:"flex justify-between items-center"},[e("div",[e("input",{staticClass:"hidden",attrs:{type:"file",id:"file-upload"},on:{change:t.handleFileUpload}}),e("label",{staticClass:"btn-primary",attrs:{for:"file-upload"}},[t._v("Upload File")]),e("span",{staticClass:"file-upload-cover px-4"},[t._v(t._s(t.fileName))])]),e("button",{staticClass:"btn-primary",on:{click:function(s){return t.importFromCSV()}}},[t._v("Import")])])])])],1)},_=[function(){var a=this,t=a._self._c;return t("thead",[t("tr",[t("th",{staticClass:"group from-column sortable-column",staticStyle:{width:"33%"}},[t("span",[a._v("IP Address")])]),t("th",{staticClass:"actions-column",staticStyle:{width:"13.4%"}})])])},function(){var a=this,t=a._self._c;return t("p",{staticClass:"text-sm mb-4"},[a._v("Pop your template path here to use a custom view. For example: "),t("code",[a._v("templates.blocked")]),a._v(" or "),t("code",[a._v("templates/blocked")])])}],w=f(v,g,_,!1,null,"e5e5e5f8",null,null);const b=w.exports;Statamic.booting(()=>{Statamic.$components.register("alt-inbound",b)});
